# iamwatching
monitoring screens of multiple computers at once

ローカルネットワーク内に存在する複数のコンピュータの操作画面を1台のコンピュータで監視する機能を提供します。


## 何ができるか
できるだけお手軽に複数PC画面の監視を行うため、次の機能を提供します。

### シンプルな導入

* 監視対象PCでのexeファイルを実行するだけで監視できます。
  - インストール操作が不要です。
  - 通信に使用するTCPポート番号を1024～65535の間で指定できます。
* 監視画面としてプログラムのインストールやサーバーは不要です。
  - 監視画面はHTML/JS/CSSによる静的なファイルで提供され、Google ChromeやMicrosoft EdgeなどのWebブラウザがあれば表示できます。
  - Webブラウザで監視対象PC1台の画面を直接表示させることもできます。
  - たぶんiPadなどのタブレットでも動きます（未確認）

### シンプルな監視機能
複数PC画面の監視に必要な機能を提供します。

* 監視対象PC画面の表示サイズを選択できます。
  - デフォルトでは240px/320px/400px/600px/1280pxから選択できます。
  - 監視画面HTMLファイルを修正すれば自由に値を設定できます。
* 監視画面を自動更新できます。
  - 監視間隔を1～300秒の間で秒単位で指定できます。
* 1台だけ別ウィンドウで拡大表示しての監視も可能です。
  * 監視対象PC画面をダブルクリックすると、その画面だけの監視画面を別に開きます（通常Webブラウザの別タブで開かれます）
* IPアドレスだけで監視対象PCを指定できます。
  - ホスト名でも指定できますが一部機能に制限があります。
* 監視対象PCのリストをCSV形式テキストのコピー＆ペーストで設定できます。
  - 監視対象画面の順序や連番IPアドレスの指定を簡単に行えます。


## Windowsでの導入

### 監視対象PC
あらかじめ cmd/target/target.go をビルドしてtarget.exeを作成しておきます。
その際、次のビルドオプションを指定することで実行時のコンソール画面を非表示にできます（この場合、終了の際にタスクマネージャからの操作が必要です）。

```
go build -ldflags -H=windowsgui target.go
```

監視対象PCの任意のフォルダにtarget.exeを格納します。

監視が必要になったらtarget.exeを実行します。実行漏れを防ぐため、スタートアップに登録しての自動起動を推奨します。
また、ファイヤーウォール等で通信がブロックされる場合は許可してください。

### 監視者PC

web/watcher/watcher.html をWebブラウザで開きます。
「監視対象指定リスト」のテキストエリアに次の情報を入力して、「リスト反映」ボタンをクリックします。

```
<IPアドレス>,<表示用ホスト名>,<コメント>
```

必須項目はIPアドレスのみですが、表示用ホスト名やコメントを省略する場合も「,」（カンマ）は必須です。

「監視開始」ボタンをクリックします。

「監視対象指定リスト」の内容はWebブラウザのリロード・更新を行うと消えてしまうため、必要であればテキストファイル等に別途保存してください。



# 注意事項
## セキュリティ
監視対象PCのプログラムの通信は単なるHTTPサーバーとしての応答であり、特にユーザー認証や暗号化の機能は提供していません。
通信を盗聴されて画面の内容がわかってしまうと問題がある場合、のぞき見不可能な経路で通信するようにしてください。

## 画像サイズ指定
監視画面の表示サイズは監視対象側プログラムにも通知されます。このとき表示サイズの指定が160pxから1280pxの範囲内であれば、監視対象側プログラムがあらかじめ画像を縮小した上で転送します。
上記の範囲に含まれないサイズ指定の場合、監視画面のHTML/CSSでは縮小表示されていますが監視対象側プログラムは画像を縮小せず送信しています。

## パフォーマンス面での想定
ローカルLANなどの通信速度がある程度確保できる環境で、最大40台程度を監視する構成を想定しています。


# 利用場面と開発動機
コンピュータを使ったハンズオン型の教育・研修では各受講者の操作状況の把握が必要です。
全員の操作画面を常時更新しつつ一覧で確認できると「だいたいみんながどこまで進んだか」や「この受講者は画面がしばらく変わっていない（＝操作に詰まっている？）」といったことがわかります。

もちろん遠隔集中監視を実現するソフトウェアはすでに多数存在しますが、わたしが利用しているもの（または使用を検討しているもの）には、次の不満がありました。

* 今後利用したいと思っている環境で動かない
* 多機能すぎる
  - 必要なのは画面監視だけで、ほかの機能は別の方法で実現している。
  - ほかの機能（遠隔操作やシャットダウン、機能制限、ファイル転送など）がある分だけ操作が複雑
* 一覧表示のパターン（サイズや表示個数の組み合わせ）が固定的
